import{c as _,a as y,r as S,o as b,b as E,f as u,d as P,e as v,g as l,h as A}from"./vendor.b0e8f9d3.js";const M=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}};M();const O="modulepreload",h={},L="/chat-app/",m=function(t,a){return!a||a.length===0?t():Promise.all(a.map(s=>{if(s=`${L}${s}`,s in h)return;h[s]=!0;const r=s.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${o}`))return;const n=document.createElement("link");if(n.rel=r?"stylesheet":O,r||(n.as="script",n.crossOrigin=""),n.href=s,document.head.appendChild(n),r)return new Promise((g,w)=>{n.addEventListener("load",g),n.addEventListener("error",w)})})).then(()=>t())},I=[{name:"Index",path:"/",component:()=>m(()=>import("./Index.658b4ce9.js"),["assets/Index.658b4ce9.js","assets/Index.14ebe8be.css","assets/vendor.b0e8f9d3.js"]),redirect:"/login",children:[{name:"Login",path:"login",component:()=>m(()=>import("./Login.f0251941.js"),["assets/Login.f0251941.js","assets/Login.312da996.css","assets/vendor.b0e8f9d3.js"])},{name:"Chat",path:"chat",component:()=>m(()=>import("./Chat.72be6041.js"),["assets/Chat.72be6041.js","assets/Chat.83421d37.css","assets/vendor.b0e8f9d3.js"]),meta:{requiresAuth:!0}},{name:"Register",path:"register",component:()=>m(()=>import("./Register.288d8384.js"),["assets/Register.288d8384.js","assets/Register.fc68c845.css","assets/vendor.b0e8f9d3.js"])}]},{path:"/:catchAll(.*)",redirect:"/login"}],c=_({linkActiveClass:"active",history:y(),routes:I});var U=(e,t)=>{for(const[a,s]of t)e[a]=s;return e};const R={};function D(e,t){const a=S("router-view");return b(),E(a)}var G=U(R,[["render",D]]);const f={apiKey:"AIzaSyCSei4bGBnDPGw3vOMuTPeR1mg4Qq5UopA",authDomain:"vue-chat-app-e373f.firebaseapp.com",projectId:"vue-chat-app-e373f",databaseURL:"https://vue-chat-app-e373f-default-rtdb.asia-southeast1.firebasedatabase.app",storageBucket:"vue-chat-app-e373f.appspot.com",messagingSenderId:"191258709366",appId:"1:191258709366:web:1007e9d9633ff375937e57",measurementId:"G-D5D6P8N5Y1"},k=u.initializeApp(f).database(),i=u.initializeApp(f).auth();var T={state:()=>({isShow:!1,message:"",style:""}),mutations:{SHOW_MSG(e,t){e.isShow=t.isShow,e.message=t.msg,e.style=t.style},REMOVE_MSG(e,t){e.isShow=t.isShow,e.message=t.msg,e.style=t.style}},actions:{removeMsg({commit:e},t){setTimeout(()=>{e("REMOVE_MSG",t)},1500)}}};const p=P({strict:!0,state:()=>({routeName:"",showMenu:!1,uid:""}),mutations:{UPDATE_ROUTE(e,t){e.routeName=t},UPDATE_UID(e,t){e.uid=t},UPDATE_MENU(e,t){e.showMenu=t}},actions:{async register({dispatch:e,commit:t},a){const{username:s,email:r,password:o}=a;try{await i.createUserWithEmailAndPassword(r,o),await i.currentUser.updateProfile({displayName:s,photoURL:"https://i.postimg.cc/mrtfw2dd/anonymous.png"}),await t("SHOW_MSG",{isShow:!0,msg:"\u8A3B\u518A\u6210\u529F!",style:"success"}),await c.push("/login"),await e("removeMsg",{isShow:!1,msg:"",style:""})}catch(n){t("SHOW_MSG",{isShow:!0,msg:"\u6B64\u5E33\u865F\u5DF2\u88AB\u4F7F\u7528",style:"error"}),e("removeMsg",{isShow:!1,msg:"",style:""})}},async threePartLogin({dispatch:e,commit:t},a){let s=new u.auth.GoogleAuthProvider;a==="facebook"&&(s=new u.auth.FacebookAuthProvider);try{await i.signInWithPopup(s),await t("SHOW_MSG",{isShow:!0,msg:"\u767B\u5165\u6210\u529F",style:"success"}),await c.push("/chat"),await e("removeMsg",{isShow:!1,msg:"",style:""})}catch{}},async userLogin({dispatch:e,commit:t},a){const{email:s,password:r}=a;try{await i.signInWithEmailAndPassword(s,r),await t("SHOW_MSG",{isShow:!0,msg:"\u767B\u5165\u6210\u529F",style:"success"}),await c.push("/chat"),await e("removeMsg",{isShow:!1,msg:"",style:""})}catch{t("SHOW_MSG",{isShow:!0,msg:"\u67E5\u7121\u6B64\u7528\u6236",style:"error"}),e("removeMsg",{isShow:!1,msg:"",style:""})}}},modules:{alert:T}});v({validateOnInput:!0});l("username",e=>!e||!e.length?"* Username can't be empty":e.length<3||e.length>10?"* Username must between 3 ~ 10 character":!0);l("email",e=>{if(!e||!e.length)return"* Email can't be empty";var t=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return t.test(e)?!0:"* Email must be a valid email"});l("password",e=>!e||!e.length?"* Password can't be empty":e.length<6||e.length>12?"* Passowrd must between 6 ~ 12 character":!0);l("confirmed",(e,[t])=>e!==t||!e||!e.length?"* Password must match":!0);let d;i.onAuthStateChanged(()=>{d||(d=A(G).use(c).use(p).mount("#app"))});c.beforeEach((e,t)=>{if(p.commit("UPDATE_MENU",!1),e.meta.requiresAuth&&!i.currentUser)return{name:"Login",query:{redirect:e.fullPath}}});export{U as _,i as a,k as d};
