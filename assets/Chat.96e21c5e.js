import{z as g,h as l,o as m,i as _,k as e,v as r,C as f,D as b,B as y,G as w,H as I,p as x,q as N,n as S}from"./vendor.1c6d3ac3.js";import{_ as D,a as U,d as h,b as B}from"./index.662689c0.js";const C={name:"Chat",setup(){const n=g(),t=l(""),i=l([]),s=l(U.currentUser),d=l(null),p=()=>{const o=new Date(Date.now()),u={hour:"2-digit",minute:"2-digit"};return o.toLocaleString("zh-TW",u)},a=()=>{const o={userId:s.value.uid,displayName:s.value.displayName,photoUrl:s.value.photoURL,message:t.value||null,createAt:Date.now(),timeFormat:p()};h.collection("messages").add(o),d.value.scrollIntoView({behavior:"smooth"}),t.value=""},c=o=>o===s.value.uid?"send":"receive";return h.collection("messages").orderBy("createAt").onSnapshot(o=>{i.value=o.docs.map(u=>u.data())}),B.emit("route",n.path),{sendMessage:a,message:t,user:s,messages:i,sentOrReceived:c,scroll:d}}},v=n=>(x("data-v-2d389b03"),n=n(),N(),n),M={class:"chat-container"},R={class:"chat-wrap"},k={class:"chat-header"},F=v(()=>e("i",{class:"fas fa-comment-dots"},null,-1)),L={class:"info"},z=["src","alt"],V={class:"chat-box"},j=["src","alt"],A={ref:"scroll"},E=["disabled"],O=v(()=>e("i",{class:"fas fa-paper-plane"},null,-1)),T=[O];function W(n,t,i,s,d,p){return m(),_("div",M,[e("div",R,[e("div",k,[F,e("div",L,[e("span",null,"Welcome, "+r(s.user.displayName),1),e("img",{src:s.user.photoURL,alt:s.user.displayName},null,8,z)])]),e("div",V,[(m(!0),_(f,null,b(s.messages,(a,c)=>(m(),_("div",{class:S(["chat-msg",s.sentOrReceived(a.userId)]),key:c},[e("img",{src:a.photoUrl,alt:a.displayName},null,8,j),e("div",null,[e("span",null,r(a.displayName),1),e("p",null,r(a.message),1)]),e("small",null,r(a.timeFormat),1)],2))),128)),e("div",A,null,512)]),e("form",{onSubmit:t[1]||(t[1]=y((...a)=>s.sendMessage&&s.sendMessage(...a),["prevent"]))},[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.message=a),class:"input-msg",placeholder:"Enter message..."},null,512),[[I,s.message]]),e("button",{disabled:!s.message,type:"submit",title:"send!"},T,8,E)],32)])])}var H=D(C,[["render",W],["__scopeId","data-v-2d389b03"]]);export{H as default};
